<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Flot Examples: Toggling Series/time axes</title>
    <link href="../examples.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="../../jquery.js"></script>
    <script language="javascript" type="text/javascript" src="../../jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="../../jquery.flot.time.js"></script>
    <script type="text/javascript">
        $(function() {

            var demoData = {
                "type": "FeatureCollection",
                "features": [{
                    "type": "Feature",
                    "properties": {
                        "type": "radon time-series",
                        "Station location": "00",
                        "Station elevation": "38",
                        "time": ["2012-11-01T00:00:00", "2012-11-01T00:15:00", "2012-11-01T00:30:00", "2012-11-01T00:45:00", "2012-11-01T01:00:00", "2012-11-01T01:15:00", "2012-11-01T01:30:00", "2012-11-01T01:45:00",
                            "2012-11-01T02:00:00", "2012-11-01T02:15:00", "2012-11-01T02:30:00", "2012-11-01T02:45:00", "2012-11-01T03:00:00", "2012-11-01T03:15:00", "2012-11-01T03:30:00", "2012-11-01T03:45:00",
                            "2012-11-01T04:00:00", "2012-11-01T04:15:00", "2012-11-01T04:30:00", "2012-11-01T04:45:00", "2012-11-01T05:00:00", "2012-11-01T05:15:00", "2012-11-01T05:30:00", "2012-11-01T05:45:00",
                            "2012-11-01T06:00:00", "2012-11-01T06:15:00", "2012-11-01T06:30:00", "2012-11-01T06:45:00", "2012-11-01T07:00:00", "2012-11-01T07:15:00", "2012-11-01T07:30:00", "2012-11-01T07:45:00",
                            "2012-11-01T08:00:00", "2012-11-01T08:15:00", "2012-11-01T08:30:00", "2012-11-01T08:45:00", "2012-11-01T09:00:00", "2012-11-01T09:15:00", "2012-11-01T09:30:00", "2012-11-01T09:45:00",
                            "2012-11-01T10:00:00", "2012-11-01T10:15:00", "2012-11-01T10:30:00", "2012-11-01T10:45:00", "2012-11-01T11:00:00", "2012-11-01T11:15:00", "2012-11-01T11:30:00", "2012-11-01T11:45:00",
                            "2012-11-01T12:00:00", "2012-11-01T12:15:00", "2012-11-01T12:30:00", "2012-11-01T12:45:00", "2012-11-01T13:00:00", "2012-11-01T13:15:00", "2012-11-01T13:30:00", "2012-11-01T13:45:00",
                            "2012-11-01T14:00:00", "2012-11-01T14:15:00", "2012-11-01T14:30:00", "2012-11-01T14:45:00", "2012-11-01T15:00:00", "2012-11-01T15:15:00", "2012-11-01T15:30:00", "2012-11-01T15:45:00",
                            "2012-11-01T16:00:00", "2012-11-01T16:15:00", "2012-11-01T16:30:00", "2012-11-01T16:45:00", "2012-11-01T17:00:00", "2012-11-01T17:15:00", "2012-11-01T17:30:00", "2012-11-01T17:45:00",
                            "2012-11-01T18:00:00", "2012-11-01T18:15:00", "2012-11-01T18:30:00", "2012-11-01T18:45:00", "2012-11-01T19:00:00", "2012-11-01T19:15:00", "2012-11-01T19:30:00", "2012-11-01T19:45:00",
                            "2012-11-01T20:00:00", "2012-11-01T20:15:00", "2012-11-01T20:30:00", "2012-11-01T20:45:00", "2012-11-01T21:00:00", "2012-11-01T21:15:00", "2012-11-01T21:30:00", "2012-11-01T21:45:00",
                            "2012-11-01T22:00:00", "2012-11-01T22:15:00", "2012-11-01T22:30:00", "2012-11-01T22:45:00", "2012-11-01T23:00:00", "2012-11-01T23:15:00", "2012-11-01T23:30:00", "2012-11-01T23:45:00",
                            "2012-11-02T00:00:00"
                        ],
                        "Station code": "ARMR",
                        "Network code": "KO",
                        "value": ["279", "316", "350", "338", "317", "317", "332", "325", "305", "322", "325", "326", "292", "335", "336", "358", "349", "321", "332", "330", "292", "320", "283", "298", "358", "340", "318", "304",
                            "329", "309", "325", "309", "307", "333", "346", "343", "336", "365", "342", "329", "322", "334", "325", "308", "325", "327", "320", "307", "298", "342", "353", "322", "344", "333", "337", "323",
                            "316", "301", "327", "310", "334", "299", "288", "335", "353", "334", "323", "320", "329", "314", "303", "364", "319", "354", "311", "348", "346", "315", "360", "347", "347", "337", "329", "345",
                            "342", "298", "326", "368", "337", "337", "320", "301", "341", "314", "353", "339", "334"
                        ]
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [30.4041, 40.70788]
                    }
                }]
            };

            var demoData_bis = {
                "type": "FeatureCollection",
                "features": [{
                    "type": "Feature",
                    "properties": {
                        "type": "radon time-series",
                        "Station location": "00",
                        "Station elevation": "38",
                        "time": ["2012-11-01T00:00:00", "2012-11-01T00:15:00", "2012-11-01T00:30:00", "2012-11-01T00:45:00", "2012-11-01T01:00:00", "2012-11-01T01:15:00", "2012-11-01T01:30:00", "2012-11-01T01:45:00",
                            "2012-11-01T02:00:00", "2012-11-01T02:15:00", "2012-11-01T02:30:00", "2012-11-01T02:45:00", "2012-11-01T03:00:00", "2012-11-01T03:15:00", "2012-11-01T03:30:00", "2012-11-01T03:45:00",
                            "2012-11-01T04:00:00", "2012-11-01T04:15:00", "2012-11-01T04:30:00", "2012-11-01T04:45:00", "2012-11-01T05:00:00", "2012-11-01T05:15:00", "2012-11-01T05:30:00", "2012-11-01T05:45:00",
                            "2012-11-01T06:00:00", "2012-11-01T06:15:00", "2012-11-01T06:30:00", "2012-11-01T06:45:00", "2012-11-01T07:00:00", "2012-11-01T07:15:00", "2012-11-01T07:30:00", "2012-11-01T07:45:00",
                            "2012-11-01T08:00:00", "2012-11-01T08:15:00", "2012-11-01T08:30:00", "2012-11-01T08:45:00", "2012-11-01T09:00:00", "2012-11-01T09:15:00", "2012-11-01T09:30:00", "2012-11-01T09:45:00",
                            "2012-11-01T10:00:00", "2012-11-01T10:15:00", "2012-11-01T10:30:00", "2012-11-01T10:45:00", "2012-11-01T11:00:00", "2012-11-01T11:15:00", "2012-11-01T11:30:00", "2012-11-01T11:45:00",
                            "2012-11-01T12:00:00", "2012-11-01T12:15:00", "2012-11-01T12:30:00", "2012-11-01T12:45:00", "2012-11-01T13:00:00", "2012-11-01T13:15:00", "2012-11-01T13:30:00", "2012-11-01T13:45:00",
                            "2012-11-01T14:00:00", "2012-11-01T14:15:00", "2012-11-01T14:30:00", "2012-11-01T14:45:00", "2012-11-01T15:00:00", "2012-11-01T15:15:00", "2012-11-01T15:30:00", "2012-11-01T15:45:00",
                            "2012-11-01T16:00:00", "2012-11-01T16:15:00", "2012-11-01T16:30:00", "2012-11-01T16:45:00", "2012-11-01T17:00:00", "2012-11-01T17:15:00", "2012-11-01T17:30:00", "2012-11-01T17:45:00",
                            "2012-11-01T18:00:00", "2012-11-01T18:15:00", "2012-11-01T18:30:00", "2012-11-01T18:45:00", "2012-11-01T19:00:00", "2012-11-01T19:15:00", "2012-11-01T19:30:00", "2012-11-01T19:45:00",
                            "2012-11-01T20:00:00", "2012-11-01T20:15:00", "2012-11-01T20:30:00", "2012-11-01T20:45:00", "2012-11-01T21:00:00", "2012-11-01T21:15:00", "2012-11-01T21:30:00", "2012-11-01T21:45:00",
                            "2012-11-01T22:00:00", "2012-11-01T22:15:00", "2012-11-01T22:30:00", "2012-11-01T22:45:00", "2012-11-01T23:00:00", "2012-11-01T23:15:00", "2012-11-01T23:30:00", "2012-11-01T23:45:00",
                            "2012-11-02T00:00:00"
                        ],
                        "Station code": "KARR",
                        "Network code": "KO",
                        "value": ["154", "138", "124", "116", "109", "141", "143", "115", "144", "140", "143", "143", "135", "146", "137", "144", "137", "156", "132", "133", "136", "146", "131", "129", "134", "149", "146", "148",
                            "145", "135", "150", "134", "147", "147", "142", "142", "149", "129", "147", "152", "150", "136", "143", "142", "143", "141", "127", "131", "131", "161", "139", "136", "130", "135", "153", "119",
                            "105", "135", "139", "117", "129", "134", "130", "131", "93", "111", "109", "99", "121", "110", "99", "123", "116", "125", "99", "96", "125", "110", "101", "97", "106", "107", "107", "102", "110",
                            "121", "113", "117", "142", "115", "107", "115", "129", "103", "93", "98", "93"
                        ]
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [30.4041, 40.70788]
                    }
                }]
            };

            var timeAr;
            var valueAr;
            $.each(demoData, function(key, val) {
                if (key == 'features') {
                    $.each(val[0], function(key2, val2) {
                        var timeAr2;
                        var valueAr2;


                        if (key2 == 'properties') {
                            $.each(val2, function(key3, val3) {
                                if (key3 == 'time') {
                                    timeAr2 = val3;
                                }
                                if (key3 == 'value') {
                                    valueAr2 = val3;
                                }
                            })
                            timeAr = timeAr2;
                            valueAr = valueAr2;
                        }
                    })
                }

            });

            var timeAr_bis;
            var valueAr_bis;
            $.each(demoData_bis, function(key, val) {
                if (key == 'features') {
                    $.each(val[0], function(key2, val2) {
                        var timeAr2;
                        var valueAr2;

                        if (key2 == 'properties') {
                            $.each(val2, function(key3, val3) {
                                if (key3 == 'time') {
                                    timeAr2 = val3;
                                }
                                if (key3 == 'value') {
                                    valueAr2 = val3;
                                }
                            })
                            timeAr_bis = timeAr2;
                            valueAr_bis = valueAr2;
                        }
                    })
                }

            });

            var inputAr = [];
            var inputAr_bis = [];
            var inputAr0 = [];
            var inputAr1 = [];
            var inputAr2 = [];
            var inputAr3 = [];
            var inputAr4 = [];
            var inputAr5 = [];

            for (var i = 0; i < timeAr.length; i++) {
                var unixTstamp = new Date(timeAr[i]);
                unixTstamp = unixTstamp.getTime();

                var randNum = Math.floor(Math.random() * 100) + 1;
                //var tempAr = [unixTstamp, randNum];
                var tempAr = [unixTstamp, valueAr[i]];

                inputAr.push(tempAr);

                switch (i % 6) {
                    case 0:
                        inputAr0.push(tempAr);
                        break;

                    case 1:
                        inputAr1.push(tempAr);
                        break;

                    case 2:
                        inputAr2.push(tempAr);
                        break;

                    case 3:
                        inputAr3.push(tempAr);
                        break;

                    case 4:
                        inputAr4.push(tempAr);
                        break;

                    case 5:
                        inputAr5.push(tempAr);
                        break;

                }
            }

            for (var j = 0; j < timeAr_bis.length; j++) {
                var unixTstamp = new Date(timeAr_bis[j]);
                unixTstamp = unixTstamp.getTime();

                var tempAr = [unixTstamp, valueAr_bis[j]];

                inputAr_bis.push(tempAr);

            }

            var datasets = {
                "usa": {
                    label: "USA",
                    data: inputAr0
                },

                "russia": {
                    label: "Russia",
                    data: inputAr1
                },
                "uk": {
                    label: "UK",
                    data: inputAr2
                },
                "germany": {
                    label: "Germany",
                    data: inputAr3
                },
                "denmark": {
                    label: "Denmark",
                    data: inputAr4
                },
                "sweden": {
                    label: "Sweden",
                    data: inputAr5
                }
            };


            // hard-code color indices to prevent them from shifting as
            // countries are turned on/off

            var i = 0;
            $.each(datasets, function(key, val) {
                val.color = i;
                ++i;
            });

            // insert checkboxes
            var choiceContainer = $("#choices");
            $.each(datasets, function(key, val) {
                choiceContainer.append("<br/><input type='checkbox' name='" + key +
                    "' checked='checked' id='id" + key + "'></input>" +
                    "<label for='id" + key + "'>" +
                    val.label + "</label>");
            });

            choiceContainer.find("input").click(plotAccordingToChoices);

            function plotAccordingToChoices() {

                var data = [];

                choiceContainer.find("input:checked").each(function() {
                    var key = $(this).attr("name");
                    if (key && datasets[key]) {
                        data.push(datasets[key]);
                    }
                });

                if (data.length > 0) {
                    $.plot("#placeholder_time", data, {
                        yaxis: {
                            min: 0
                        },
                        xaxis: {
                            mode: "time",
                            timeformat: "%d/%m/%Y %H:%M"
                        }
                    });
                }
            }

            plotAccordingToChoices();

            ///////////////////////////////////

            $.plot("#placeholder", [inputAr], {
                xaxis: {
                    mode: "time",
                    timeformat: "%d/%m/%Y %H:%M"
                }
            });

            $.plot("#placeholder2", [inputAr_bis], {
                xaxis: {
                    mode: "time",
                    timeformat: "%d/%m/%Y %H:%M"
                }
            });
        });
    </script>
</head>

<body>


    <div id="header">
        <h2>Toggling Series & Time Axes</h2>
    </div>

    <div id="content">

        <div class="demo-container">
            <div id="placeholder" class="demo-placeholder"></div>
        </div>

        <p>This is a plot representing a generic value trend (y axis) over an time interval (x axis)</p>

        <hr /><br /><br />

        <div class="demo-container">
            <div id="placeholder2" class="demo-placeholder"></div>
        </div>

        <p>This is a plot representing a generic value trend (y axis) over an time interval (x axis)</p>

        <hr /><br /><br />

        <div class="demo-container">
            <div id="placeholder_time" class="demo-placeholder" style="float:left; width:675px;"></div>
            <p id="choices" style="float:right; width:135px;"></p>
        </div>

        <p>This example is an interactive plot. You can turn options on and off with the checkboxes next to the plot.</p>

    </div>

    <div id="footer">
        &copy; INGV EPOS team
    </div>

</body>

</html>
